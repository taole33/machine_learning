### プロローグ1~4  
#### 識別モデルと生成モデル
識別モデル - データを目的のクラスに分類する。画像をもとに、どのクラスにわけられそうか、を確率で考える。  
生成モデル - 特定のクラスのデータを生成する。文字などの入力をもとに、どのピクセルに色をつければそれになりそうかを確率で考える。  
![image](https://user-images.githubusercontent.com/20613753/139427260-243d3a83-4b33-4720-ac6c-adbaa7ce3639.png)  

#### 識別器
![image](https://user-images.githubusercontent.com/20613753/139427425-77aaf620-6564-4448-961a-3d419a86aebc.png)  
ベイズの定理により生成モデルを使って、識別モデルを作成することもできる。  
識別関数は、確率ではなく0,1で出力する。  

識別モデル  
![image](https://user-images.githubusercontent.com/20613753/139434340-8bea0d74-7f33-4f57-a928-bf89899413f4.png)  
  
生成モデル  
![image](https://user-images.githubusercontent.com/20613753/139434657-c700cc88-29f5-4827-baa5-b4b332b0d8ae.png)  

#### 万能近似定理
非線形な活性化関数を使うことで、どんな関数でも近似化できる

### 01ニューラルネットワークの全体像
入力層、中間層、出力層の3層に分かれる

#### ニューラルネットワークでできること
回帰と分類  
![image](https://user-images.githubusercontent.com/20613753/139438431-c5253760-fd30-4404-8756-fbf11c5cabfe.png)  
![image](https://user-images.githubusercontent.com/20613753/139438451-54cbc0ae-17a1-42aa-9cce-1124fd8663cd.png)
  
数字を入力して、数字を出力するという思想。  
文章を入出力するものは、それらを数字に変換して処理している。

### 02入力層～中間層
1次関数の傾きと切片を求めることが目的。(傾き=w、切片=b)  
![image](https://user-images.githubusercontent.com/20613753/139520309-9a708d43-0ee1-47ff-acbf-80b587cd66fb.png)  

![image](https://user-images.githubusercontent.com/20613753/139522252-11194e30-18ec-4647-9cfd-08020288e8cf.png)  
↓コードで書くとこうなる  
![image](https://user-images.githubusercontent.com/20613753/139522304-4f516378-da22-4a95-b3fe-cd9603d8e05c.png)  

![image](https://user-images.githubusercontent.com/20613753/139522322-293a00b2-0654-4612-ac9c-7bda720465e7.png)  
↓コードで書くとこうなる  
![image](https://user-images.githubusercontent.com/20613753/139522347-7576d736-15d0-4837-9a78-a8b13fe5ff2a.png)  

### 03活性化関数
活性化関数→非線形の関数  
入力層の結果に活性化関数を通すことで、複雑な関数を作ることができる  

活性化関数の種類
ステップ関数-今はあまり使われない  
![image](https://user-images.githubusercontent.com/20613753/139523109-b003b6e3-fcdb-46ad-9eef-612c78dc43e3.png)  
  
シグモイド関数-勾配消失問題  
![image](https://user-images.githubusercontent.com/20613753/139523122-5479118d-8729-4b95-babe-e1a0c94ba549.png)  
  
RELU関数-勾配消失問題が比較的起こりにくい  
![image](https://user-images.githubusercontent.com/20613753/139523144-3c3a96f4-c0f2-4c55-80b2-c8a1f25a5a66.png)  


【実装演習結果】
![image](https://user-images.githubusercontent.com/20613753/139523478-ed71b923-3254-4024-962e-03da9bc27125.png)  
![image](https://user-images.githubusercontent.com/20613753/139523489-0e1284f7-c659-45cf-b466-55cb0de48873.png)  
![image](https://user-images.githubusercontent.com/20613753/139523502-c0388b13-729d-4f32-a968-434ea82f04f3.png)  
![image](https://user-images.githubusercontent.com/20613753/139523551-0cc87198-05fa-416c-80ff-b9b893b24274.png)  
![image](https://user-images.githubusercontent.com/20613753/139523559-3af34597-20a5-4c5b-9621-4a32e08ab09a.png)  
![image](https://user-images.githubusercontent.com/20613753/139523576-776d1e38-2664-4d3c-9141-dab7685023e4.png)  
![image](https://user-images.githubusercontent.com/20613753/139523586-d05a11ef-4e7e-4123-bd4a-c3be7593dfdb.png)  
![image](https://user-images.githubusercontent.com/20613753/139523609-6cd19b25-260d-4580-934f-f82d51566ebb.png)  
![image](https://user-images.githubusercontent.com/20613753/139523617-d9ae7277-6233-4a67-b377-b507bc1380f1.png)  
![image](https://user-images.githubusercontent.com/20613753/139523633-b381239e-27fa-491b-8a31-8f3a15a00f77.png)  
![image](https://user-images.githubusercontent.com/20613753/139523637-1c3b9fcb-6548-47bd-897d-f1b62dad51c7.png)  
![image](https://user-images.githubusercontent.com/20613753/139523643-1292fa6b-73ea-4b2e-8780-d4f6c6cff919.png)  
![image](https://user-images.githubusercontent.com/20613753/139523650-010473f8-3f4c-4a18-af39-0833d5ab3523.png)  
![image](https://user-images.githubusercontent.com/20613753/139523653-8fd49c2c-c0e3-4fdc-97c5-70db64c9fd59.png)  
![image](https://user-images.githubusercontent.com/20613753/139523655-1bcffaca-7e40-4b78-a008-5944b67dac53.png)  
![image](https://user-images.githubusercontent.com/20613753/139523657-88a4cf9e-b86c-45ec-b0f7-a00e0a790f05.png)  
![image](https://user-images.githubusercontent.com/20613753/139523668-c7fbd48b-24a0-4b04-9f7a-bb82de05f86c.png)  
![image](https://user-images.githubusercontent.com/20613753/139523675-4a2b12f6-2b7d-4b72-8d13-8a25e3c4cab7.png)  
![image](https://user-images.githubusercontent.com/20613753/139523680-9e304aa6-1083-4c36-8dc8-febdfe28b79a.png)  
![image](https://user-images.githubusercontent.com/20613753/139523682-b71cdb17-2698-451d-af09-890d2283315c.png)  
![image](https://user-images.githubusercontent.com/20613753/139523685-4595b289-5d53-42f7-9601-a3b6935d4827.png)

### 04出力層_誤差関数
出力層  
![image](https://user-images.githubusercontent.com/20613753/139523794-11be6523-b99e-4bad-a6e1-855f70cead24.png)  
出力したものと訓練データを比較し、どれくらい正解から外れていたかを誤差関数で計算する。  
  
誤差関数が2乗誤差の場合の式  
![image](https://user-images.githubusercontent.com/20613753/139523911-d4f8cc84-289b-44db-8139-76b3055d69ae.png)  
式の頭についている1/2は、微分する際、2乗であるので、式全体に×2が行われるため。  
（計算が簡単になる。本質的な意味はない）  

### 05出力層_活性化関数
出力層と中間層で使われる活性化関数は異なる。  
出力層では、以下の活性化関数が使われる。  
・恒等写像  
・シグモイド関数  
・ソフトマックス関数  
![image](https://user-images.githubusercontent.com/20613753/139526806-5cb60ae5-b60c-452d-89d3-e8fabd23fda9.png)  
求めたい答えに応じて、使われる活性化関数と誤差関数が異なる。  
![image](https://user-images.githubusercontent.com/20613753/139526840-7ab389eb-c256-445e-9d7b-34313d2aa762.png)  

'''
# ソフトマックスとクロスエントロピーの複合導関数
def d_softmax_with_loss(d, y):
    batch_size = d.shape[0]
    if d.size == y.size: # 教師データがone-hot-vectorの場合
        dx = (y - d) / batch_size
    else:
        dx = y.copy()
        dx[np.arange(batch_size), d] -= 1
        dx = dx / batch_size
    return dx
'''
